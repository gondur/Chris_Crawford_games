resource 'STR#' (700) {{"% is sitting on an antique aluminum rocking-seat.";"% is reclining on a sofa in the far corner of the room.";"% has apparently just awakened from a nap and is still groggy.";"% squats on the floor in the corner; perhaps @ was meditating."}};resource 'STR#' (701) {{"% is in the kitchen cooking a smelly concoction for ^ meal.";"% is seated at the table eating a leafy vegetable dish.";"% is just cleaning up the dishes from one of those foul-smelling & meals.";"% is chopping some food in preparation for a meal."}};resource 'STR#' (702) {{"% is toying with a pair of metal marbles.";"% is contemplatively fingering an old metal coin.";"% sits on the hard floor trying to fathom the mysteries of a tippe-top.";"% stands, a kitchen knife in hand, staring quietly at it."}};resource 'STR#' (703) {{"% is leaning against a bookcase, flipping through an old history book.";"% sits at a table, writing on some papers.";"% stands near the window for light, closely examining an old book.";"% is mulling over an old ledger or diary."}};resource 'STR#' (720) {{"%'s hate-filled gaze makes you feel profoundly uneasy.";"% looks at you with such hatred that you feel decidedly unwelcome.";"One glance at %'s face tells you that @ does not like you at all.";"Something about %'s demeanor communicates a powerful sense of hatred for you."}};resource 'STR#' (721) {{"@ struggles to conceal the distaste that @ so obviously holds for you.";"It is painfully obvious that @ is not pleased to see you.";"% fumbles about, trying to retain propriety with someone whom @ obviously does not like.";"Is @ this cold with all people, or only with you?"}};resource 'STR#' (722) {{"%'s facial expression is polite, even nice, but not particularly warm.";"@ seems pleasant enough.";"The smile on %'s face is pleasant and proper but little more.";"% is neither warm nor cold."}};resource 'STR#' (723) {{"@ is pleased to see you, that much is easy to see.";"^ face reveals ^ pleasure at seeing you.";"At least you can count on % as one of your friends.";"No doubt about it, % likes you."}};resource 'STR#' (724) {{"An expression of great pleasure animates ^ face.";"@ is very happy to see you.";"You immediately feel very welcome in ^ house.";"%'s face radiates happiness and pleasure at seeing you."}};resource 'STR#' (730) {{"@ frantically conceals some papers that @ was reading.";"% eyes you with extreme distrust.";"The air is heavy with the distrust that % obviously feels for you.";"You can tell that % does not trust you one bit."}};resource 'STR#' (731) {{"Buried in %'s gaze is an undeniable element of distrust.";"% does not trust you.";"You can see that, however else @ may feel about you, % certainly doesn't trust you.";"%'s eyes are guarded with distrust."}};resource 'STR#' (732) {{"@ stares at you momentarily; what is @ gauging?";"@ stares at you momentarily; what is @ gauging?";"@ stares at you momentarily; what is @ gauging?";"@ stares at you momentarily; what is @ gauging?"}};resource 'STR#' (733) {{"@ trusts you somewhat.";"@ trusts you somewhat.";"@ trusts you somewhat.";"@ trusts you somewhat."}};resource 'STR#' (734) {{"@ trusts you a lot.";"@ trusts you a lot.";"@ trusts you a lot.";"@ trusts you a lot."}};resource 'STR#' (740) {{"% greets you with a derisive wave of the hand.";"^ salutation is a dismissive gesture.";"^ lips curl with a barely-disguised contemptuous sneer.";"% snorts in contempt at you."}};resource 'STR#' (741) {{"% does not even bother to turn to face you.";"% doesn't seem very impressed by your entrance.";"% hardly notices your presence.";"% almost seems to be ignoring you."}};resource 'STR#' (742) {{"%'s greeting is formal and proper.";"% grees you with decency.";"%'s greeting is formal and proper.";"%'s greeting is formal and proper."}};resource 'STR#' (743) {{"@ bows slightly, in the old tradition.";"@ bows slightly, in the old tradition.";"@ bows slightly, in the old tradition.";"@ bows slightly, in the old tradition."}};resource 'STR#' (744) {{"@ scurries to offer you the finest chair in the house.";"@ scurries to offer you the finest chair in the house.";"@ scurries to offer you the finest chair in the house.";"@ scurries to offer you the finest chair in the house."}};resource 'STR#' (750) {{"% accidently bumps into a box and sends it flying with a vicious kick.";"% accidently bumps into a box and sends it flying with a vicious kick.";"% accidently bumps into a box and sends it flying with a vicious kick.";"% accidently bumps into a box and sends it flying with a vicious kick."}};resource 'STR#' (751) {{"@ mutters some indefinite oaths to $self";"@ mutters some indefinite oaths to $self";"@ mutters some indefinite oaths to $self";"@ mutters some indefinite oaths to $self"}};resource 'STR#' (752) {{"A screaming child just outside provokes only a resigned sigh.";"A screaming child just outside provokes only a resigned sigh.";"A screaming child just outside provokes only a resigned sigh.";"A screaming child just outside provokes only a resigned sigh."}};resource 'STR#' (753) {{"@ is whistling some old & song to $self.";"@ is whistling some old & song to $self.";"@ is whistling some old & song to $self.";"@ is whistling some old & song to $self."}};resource 'STR#' (754) {{"@ seems to be relishing some secret joke.";"@ seems to be relishing some secret joke.";"@ seems to be relishing some secret joke.";"@ seems to be relishing some secret joke."}};resource 'STR#' (760) {{"% is quite unsure of $self.";"% is quite unsure of $self.";"% is quite unsure of $self.";"% is quite unsure of $self."}};resource 'STR#' (761) {{"% seems hesitant.";"% seems hesitant.";"% seems hesitant.";"% seems hesitant."}};resource 'STR#' (762) {{"A shaft of sunlight pours in through the window.";"A shaft of sunlight pours in through the window.";"A shaft of sunlight pours in through the window.";"A shaft of sunlight pours in through the window."}};resource 'STR#' (763) {{"'What am I doing here?', you wonder.";"'What am I doing here?', you wonder.";"'What am I doing here?', you wonder.";"'What am I doing here?', you wonder."}};resource 'STR#' (764) {{"You cannot help but notice the glint of iron determination in %'s eyes.";"You cannot help but notice the glint of iron determination in %'s eyes.";"You cannot help but notice the glint of iron determination in %'s eyes.";"You cannot help but notice the glint of iron determination in %'s eyes."}};resource 'STR#' (770) {{"**";"**";		"**";"**"}};resource 'STR#' (771) {{"**";"**";		"**";"**"}};resource 'STR#' (772) {{"**";"**";		"**";"**"}};resource 'STR#' (773) {{"**";"**";		"**";"**"}};resource 'STR#' (774) {{"**";"**";		"**";"**"}};resource 'STR#' (840) {{"You note an old painting on the near wall.";"You note an old painting on the near wall.";"You note an old painting on the near wall.";"You note an old painting on the near wall."}};resource 'STR#' (841) {{"The house is a wreck; various personal items lay strewn about.";"The house is a wreck; various personal items lay strewn about.";"The house is a wreck; various personal items lay strewn about.";"The house is a wreck; various personal items lay strewn about."}};resource 'STR#' (842) {{"A broken plastic chair blocks your path.";"A broken plastic chair blocks your path.";"A broken plastic chair blocks your path.";"A broken plastic chair blocks your path."}};resource 'STR#' (843) {{"@ opens the window.";"@ opens the window.";"@ opens the window.";"@ opens the window."}};{********************************************************************************}PROCEDURE ESPFeel(Guest,Host: Integer);CONST  BoxWords = 10;  TopBox = 100;  LeftBox = 8*BoxWords;VAR  i,j,x:  		Integer;  LoclRect:    	Rect;  LoclBits:    	ARRAY[1..5280] OF Integer;  LoclBMap:    	BitMap;  Intro:	   	PACKED ARRAY[1..1024] OF Char;  SaveRect:		Rect;  BookMark:		Integer;  FinalStr:		Str255;  StartI:		Integer;  EndI:			Integer;  EndFlag:		Boolean;  LineNum:		Integer;  TempRect:		Rect;  LocalOther:	Integer;{---------------------------------------------------------------------------}FUNCTION NewInvert(Value: Integer): Integer;BEGIN  NewInvert:=1;  IF Value>-84 THEN NewInvert:=2;  IF Value>-52 THEN NewInvert:=3;  IF Value>-28 THEN NewInvert:=4;  IF Value>-8 THEN NewInvert:=5;  IF Value>8 THEN NewInvert:=6;  IF Value>28 THEN NewInvert:=7;  IF Value>52 THEN NewInvert:=8;  IF Value>84 THEN NewInvert:=9;END;    {---------------------------------------------------------------------------}FUNCTION Rnd4: Integer;BEGIN  Rnd4:=Abs(Random div 8192)+1;END;{---------------------------------------------------------------------------}PROCEDURE BuildSntc(IdNumber,Value: Integer);VAR  TempStr:	Str255;  SntcStr:	Str255;  SntcOut:	PACKED ARRAY[1..256] OF Char;  i,j,k,x:	Integer;  NewJ:		Integer;  CapFlag:	Boolean;  TestChar:	Char;{:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::}PROCEDURE MyConcat(NewString: Str255);VAR  i:	Integer;BEGIN  FOR i:=1 TO Length(NewString) DO SntcOut[Newj+i-1]:=NewString[i];  Newj:=Newj+Length(NewString);END;{:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::}BEGIN  GetIndString(SntcStr,IdNumber,Value);  SntcStr:=Concat(SntcStr,'  ');  Newj:=1;  FillChar(SntcOut,256,' ');  FOR i:=1 TO Length(SntcStr) DO	BEGIN	  CapFlag:=TRUE;	  CASE SntcStr[i] OF		'~': MyConcat('you');		'%': BEGIN MyConcat(CharName[LocalOther]); CapFlag:=FALSE; END;		'@': IF Male[LocalOther] THEN MyConcat('he') ELSE MyConcat('she');		'#': IF Male[LocalOther] THEN MyConcat('his') ELSE MyConcat('hers');		'$': IF Male[LocalOther] THEN MyConcat('him') ELSE MyConcat('her');		'^': IF Male[LocalOther] THEN MyConcat('his') ELSE MyConcat('her');		'&': MyConcat(Species[LocalOther]);		otherwise BEGIN SntcOut[Newj]:=SntcStr[i]; Newj:=Newj+1; CapFlag:=FALSE; END;	  END;	  IF (i=1) & CapFlag THEN SntcOut[1]:=Char(ord(SntcOut[1])-32);	END;  FOR i:=1 TO Newj DO Intro[BookMark+i]:=SntcOut[i];  BookMark:=BookMark+Newj;END;{-------------------------------------------------------------------------}BEGIN  IF Guest=Player THEN LocalOther:=Host ELSE LocalOther:=Guest;  SetRect(LoclRect,LeftBox,TopBox,512-LeftBox,TopBox+120);  LoclBMap.rowBytes:=64-(2*BoxWords);  LoclBMap.baseAddr:=@LoclBits;  LoclBMap.bounds:=LoclRect;  CopyBits(ScreenBits,LoclBMap,LoclRect,LoclRect,srcCopy,NIL);  FillRect(LoclRect,black);  TempRect:=LoclRect;  FOR i:=1 TO 7 DO 	BEGIN	  InsetRect(TempRect,1,1);	  InvertRect(TempRect);	END;  BookMark:=0;  BuildSntc(904,Rnd4);  BuildSntc(901,NewInvert(Love[LocalOther,Player]));  BuildSntc(902,NewInvert(Trust[LocalOther,Player]));  BuildSntc(903,NewInvert(Fear[LocalOther,Player]));  TextFont(1);  TextSize(12);   StartI:=1;  LineNum:=0;  EndFlag:=FALSE;  WHILE NOT EndFlag DO	BEGIN	  EndI:=StartI+50;	  IF Endi>=BookMark THEN BEGIN EndFlag:=TRUE; EndI:=BookMark; END;	  REPEAT EndI:=EndI-1 UNTIL Intro[EndI]=' ';	  FinalStr:='                                                  ';	  FOR j:=StartI TO EndI DO FinalStr[j-StartI+1]:=Intro[j];	  StartI:=EndI+1;	  MoveTo(LeftBox+24,TopBox+30+16*LineNum);	  DrawString(FinalStr);	  LineNum:=LineNum+1;	END;  TextFont(0);  TextSize(12);  FinalStr:='Click mouse to continue';  MoveTo(256-(StringWidth(FinalStr) div 2),TopBox+108);  DrawString(FinalStr);  REPEAT SystemTask; UNTIL Button;  FillRect(LoclRect,gray);  REPEAT SystemTask; UNTIL NOT Button;  CopyBits(LoclBMap,Screenbits,LoclRect,LoclRect,srcCopy,NIL);  FlushEvents(EveryEvent,0);END;resource 'STR#' (901) {{"@ hates you intensely.";"@ hates you.";"@ dislikes you very much.";		"@ does not like you.";"@ neither likes nor dislikes you.";"@ likes you.";"@ likes you very much.";"@ loves you.";"@ loves you intensely."}};resource 'STR#' (902) {{"@ has absolutely no trust in you.";"@ distrusts you very much.";		"@ does not trust you.";"@ distrusts you a little.";"@ neither trusts nor distrusts you.";"@ trusts you a little.";"@ trusts you.";"@ trusts you a lot.";"@ trusts you absolutely."}};resource 'STR#' (903) {{"@ is intensely fearful of you.";"@ is very fearful of you.";		"@ fears you.";"@ fears you a little.";"@ does not fear you.";"@ feels  a little confident with you.";"@ feels confident with you.";"@ feels very confident with you.";"@ feels dominant over you."}};resource 'STR#' (904) {{"%'s auras mix with yours.";"You can sense %'s feelings through ^ auras now.";		"%'s auras swirl around you, imparting a sense for ^ feelings.";"Your heightened awareness lets you probe %'s feelings."}};resource 'STR#' (999) {{"**";"**";		"**";"**"}};{********************************************************************************}PROCEDURE Dotify;CONST  headerSize = 512;  BufSize = 512;  srcBlocks = 8;TYPE  diskBlock = packed array [1..512] OF QDbyte;VAR  RefNum:    			Integer;  showRect,lineRect:	Rect;  dstBMap:	    		BitMap;  dstBits:		      	packed array [1..72] of byte;  srcPtr,dstPtr:		Ptr;  Count:		      	LongInt;  error:		      	OSErr;  srcBuf:		      	ARRAY [1..srcBlocks] OF diskBlock;  LoclRect:		 		Rect;  LoclBits:		 		ARRAY[1..10944] OF Integer;  LoclBMap:		 		BitMap;  DumPoint:				Point;  DumStrng:				Str255;  MyTypeList:		 	SFTypeList;  MyReply:		 		SFReply;  Clicked:				Boolean;  DotFaceX,DotFaceY:	PACKED ARRAY[1..34] OF Byte;  i,x,y,srcSize:		Integer;  OldX,OldY,FaceIndx:	Integer;  TempString:			Str255;  Idiot:				StringPtr;{------------------------------------------------------------------------}PROCEDURE Junko(Junky: Integer);BEGIN  MoveTo(OldX+256,OldY);  LineTo(x+256,y);  LineTo(DotFaceX[Junky]+256,DotFaceY[Junky]);END;{------------------------------------------------------------------------}BEGIN  SetRect(LoclRect,0,0,512,342);  LoclBMap.rowBytes:=64;  LoclBMap.baseAddr:=@LoclBits;  LoclBMap.bounds:=LoclRect;  CopyBits(Screenbits,LoclBMap,LoclRect,LoclRect,srcCopy,NIL);  dstBMap.rowBytes:=64;  dstBMap.baseAddr:=@dstBits;  SetRect(dstBMap.bounds,0,0,512,1);    REPEAT	FillRect(LoclRect,white);	DumPoint.h:=100; DumPoint.v:=100;	DumStrng:='FaceFile Name:';	MyTypeList[0]:='PNTG';	SFGetFile(DumPoint,DumStrng,NIL,1,MyTypeList,NIL,MyReply);	FillRect(LoclRect,white);	MoveTo(100,50);	IF MyReply.good THEN		error:=FSOpen(MyReply.fName,myReply.VRefNum,RefNum)	  ELSE FillRect(LoclRect,gray);	IF error<>0 THEN FillRect(LoclRect,black);	x:=Length(MyReply.fName)-9;	TempString:=Copy(MyReply.fName,10,x);	StringToNum(TempString,Count);	FaceIndx:=Integer(Count);	MoveTo(500,30); MyWrite(FaceIndx);	Count:=headerSize;	error:=FSRead(RefNum,Count,@srcBuf);	srcSize:=srcBlocks*512;	Count:=srcSize;	error:=FSRead(refNum,Count,@srcBuf);	Count:=Count-512;	srcPtr:=@srcBuf;	dstPtr:=pointer(dstBMap.baseAddr);	SetRect(lineRect,0,0,512,1);	SetRect(showRect,0,0,512,1);	FOR i:=1 to 256 do	  BEGIN		UnpackBits(srcPtr,dstPtr,72);		CopyBits(dstBMap,ScreenBits,lineRect,showRect,srcCopy,NIL);		dstPtr:=pointer(dstBMap.baseAddr);		OffsetRect(showRect,0,1);		IF ORD(srcPtr)>(ORD(@srcBuf)+srcSize-512) THEN		  BEGIN			srcBuf[1]:=srcBuf[srcBlocks];			error:=FSRead(refNum,Count,@srcBuf[2]);			srcPtr:=pointer(ord(srcPtr)+512-srcSize);		  END;	  END;	error:=FSClose(RefNum);	SetCursor(GetCursor(CrossCursor)^^);	FOR i:=1 TO 34 DO	  BEGIN {gather dots}		MoveTo(10,300);		PenNormal;		CASE i OF		  1: DrawString('Left Pupil');		  2: DrawString('Right Pupil');		  3: DrawString('Left Eye Inside Point');		  4: DrawString('Left Eye Top#1');		  5: DrawString('Left Eye Top#2');		  6: DrawString('Left Eye outside point');		  7: DrawString('Left Eye bottom#1');		  8: DrawString('Left Eye bottom#2');		  9: DrawString('Right Eye Inside point');		  10: DrawString('Right Eye Top#1');		  11: DrawString('Right Eye Top#2');		  12: DrawString('Right Eye outside point');		  13: DrawString('Right Eye bottom #1');		  14: DrawString('Right Eye bottom #2');		  15: DrawString('Left Eyebrow outside corner');		  16: DrawString('Left Eyebrow lower third outside');		  17: DrawString('Left Eyebrow lower third inside');		  18: DrawString('Left Eyebrow inside corner');		  19: DrawString('Left Eyebrow upper third inside');		  20: DrawString('Left Eyebrow upper third outside');		  21: DrawString('Right Eyebrow outside corner');		  22: DrawString('Right Eyebrow lower third outside');		  23: DrawString('Right Eyebrow lower third inside');		  24: DrawString('Right Eyebrow inside corner');		  25: DrawString('Right Eyebrow upper third inside');		  26: DrawString('Right Eyebrow upper third outside');		  27: DrawString('Left Mouth corner');		  28: DrawString('Left mouth lower quarter');		  29: DrawString('Mouth lower center');		  30: DrawString('Right mouth lower quarter');		  31: DrawString('Right mouth corner');		  32: DrawString('Right mouth upper quarter');		  33: DrawString('Mouth upper center');		  34: DrawString('Left mouth upper quarter');		END;		Clicked:=FALSE;		REPEAT		  SystemTask;		  IF GetNextEvent(everyEvent,myEvent)THEN			BEGIN			  IF myEvent.what=mouseDown THEN				BEGIN				  Clicked:=TRUE;				  DotFaceX[i]:=MyEvent.where.h;				  DotFaceY[i]:=MyEvent.where.v;				  x:=DotFaceX[i];				  y:=DotFaceY[i];				  IF i>1 THEN 					BEGIN					  OldX:=DotFaceX[i-1];					  OldY:=DotFaceY[i-1];					END;				  CASE i OF 					1,2:  BEGIN SetRect(ShowRect,x+250,y-6,x+262,y+6); FillOval(ShowRect,black); END;					 3,9,15,21,27: MoveTo(x+256,y);					 8: Junko(3);					14: Junko(9);					20: Junko(15);					26: Junko(21);					34: Junko(27);					otherwise BEGIN MoveTo(OldX+256,OldY); LineTo(x+256,y); END;				  END;			  END;		  END;		UNTIL Clicked;		ClearRect(10,280,500,310);	  END;	FOR i:=1 TO 34 DO DotFace^^[34*FaceIndx+i]:=Integer(BOR(BSL(DotFaceX[i],8),DotFaceY[i]));	REPEAT UNTIL NOT Button;	REPEAT UNTIL Button;	Count:=TickCount;	REPEAT UNTIL NOT Button;	REPEAT UNTIL Button;  UNTIL (TickCount-Count)>60;  InitCursor;  error:=GetVol(Idiot,RefNum);  error:=Create('DataFrame:Siboot_Ä:FaceData',RefNum,'SIBT','SBTD');  RefNum:=MyOpen('FaceData');  Count:=LongInt(6800);  error:=FSWrite(RefNum,Count,@DotFace^^);  error:=FSClose(RefNum);  REPEAT UNTIL NOT Button;  REPEAT UNTIL Button;  CopyBits(LoclBMap,ScreenBits,LoclRect,LoclRect,srcCopy,NIL);END;{********************************************************************************}{********************************************************************************}PROCEDURE ChgLove;VAR x:  Integer;BEGIN  {$IFC DebugFlg}    IF (ForWhom>NumChars) OR (ForWhom<1) THEN	  BEGIN	    MoveTo(100,100);		DrawString('BigBug! Sentence= ');		FOR x:=1 TO SntcLeng DO		  BEGIN MyWrite(Sentence[Who,x]); DrawString(' '); END;		ForWhom:=1;		x:=Sentence[Who,x+1];	  END;  {$ENDC}  x:=Love[Who,ForWhom]+HowMuch;  IF x>127 THEN x:=127;  IF x<-127 THEN x:=-127;  Love[Who,ForWhom]:=x;END;{********************************************************************************}PROCEDURE ChgTrust;VAR x:  Integer;BEGIN  {$IFC DebugFlg}    IF (ForWhom>NumChars) OR (ForWhom<1) THEN	  BEGIN	    MoveTo(100,100);		DrawString('BigBug! Sentence= ');		FOR x:=1 TO SntcLeng DO		  BEGIN MyWrite(Sentence[Who,x]); DrawString(' '); END;		ForWhom:=1;		x:=Sentence[Who,x+1];	  END;  {$ENDC}  x:=Trust[Who,ForWhom]+HowMuch;  IF x>127 THEN x:=127;  IF x<-127 THEN x:=-127;  Trust[Who,ForWhom]:=x;END;{********************************************************************************}PROCEDURE ChgFear;VAR x:  Integer;BEGIN  {$IFC DebugFlg}    IF (ForWhom>NumChars) OR (ForWhom<1) THEN	  BEGIN	    MoveTo(100,100);		DrawString('BigBug! Sentence= ');		FOR x:=1 TO SntcLeng DO		  BEGIN MyWrite(Sentence[Who,x]); DrawString(' '); END;		ForWhom:=1;		x:=Sentence[Who,x+1];	  END;  {$ENDC}  x:=Fear[Who,ForWhom]+HowMuch;  IF x>127 THEN x:=127;  IF x<-127 THEN x:=-127;  Fear[Who,ForWhom]:=x;END;{********************************************************************************}PROCEDURE ChgDlogMood;VAR x:  Integer;BEGIN  {$IFC DebugFlg}    IF Who>NumChars THEN	  BEGIN	    MoveTo(100,100);		DrawString('BigBug! Sentence= ');		FOR x:=1 TO SntcLeng DO		  BEGIN MyWrite(Sentence[Who,x]); DrawString(' '); END;		Who:=1;	  END;  {$ENDC}  x:=DlogMood[Who]+HowMuch;  IF x>127 THEN x:=127;  IF x<-127 THEN x:=-127;  DlogMood[Who]:=x;END;